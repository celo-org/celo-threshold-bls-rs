name: Contract and Cross Platform
on:
  pull_request:
  push:
    branches:
      - main


jobs:
  # contracts:
  #   name: Test Contracts
  #   runs-on: ubuntu-latest

  #   steps:
  #     - uses: actions/checkout@v1
  #     - uses: actions/setup-node@v1
  #       with:
  #         node-version: '16'
  #     - name: Install dependencies
  #       run: cd solidity && yarn
  #     - name: Build packages
  #       run: cd solidity && yarn build
  #     - name: Run contract tests
  #       run: cd solidity && yarn test


  cross-ios:
    runs-on: macos-latest
    env: 
      DEVELOPER_DIR: /Applications/Xcode_11.4.app/Contents/Developer
    # macos:
    #   xcode: 11.4.0
    # working_directory: ~/work
    steps:
      - uses: actions/checkout@v2
      - name: Install rustup
        run: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
      - name: Install Rust 1.41
        run: rustup install 1.41.0 && rustup default 1.41.0
      - name: Install iOS targets
        run: rustup target add armv7-apple-ios armv7s-apple-ios aarch64-apple-ios x86_64-apple-ios
      - name: Build iOS
        run: cd crates/threshold-bls-ffi/cross && make ios
    # - store_artifacts:
    #     path: ~/work/cross/react-native/ios      
